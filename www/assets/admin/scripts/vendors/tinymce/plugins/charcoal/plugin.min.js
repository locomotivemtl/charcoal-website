/*! @locomotivemtl/charcoal-admin */

!function(l,r){var m=l.util.Tools.each,a=l.util.Tools.extend,s=l.util.Tools.isArray;l.create("tinymce.plugins.Charcoal",{dependencies:["advlist"],listItems:["bullist","numlist","outdent","indent"],alignItems:["alignleft","aligncenter","alignright","alignjustify"],editor:null,init:function(a){var t,e,o=this;this.editor=a,t=this.filterItems(this.listItems),e=this.filterItems(this.alignItems),a.addMenuItem("lists",{text:"Lists",context:"format",menu:t}),a.addMenuItem("alignment",{text:"Alignment",context:"format",menu:e}),a.addButton("alignment",{type:"menubutton",title:"Alignment",icon:o.getDefaultAlignment(),menu:e,onPostRender:function(){var i=this;a.on("NodeChange",function(t){var e,n=this.formatter.matchAll(o.alignItems);s(n)&&(n=n.pop()),n?"IMG"===t.element.nodeName&&(e=a.dom.getParent(t.element,"figure")||t.element,"alignnone"===n?i.active(!/\bu-align-(left|center|right)\b/.test(e.className)):i.active(a.dom.hasClass(e,n))):n=o.getDefaultAlignment(),i.icon(n)})}}),a.on("init",function(){var t=l.Env,e=a.getDoc(),n=a.dom,i=["charcoal-editor"];i.push("mceContentBody"),"rtl"===a.getParam("directionality")&&(i.push("rtl"),n.setAttrib(e.documentElement,"dir","rtl")),n.setAttrib(e.documentElement,"lang",a.getParam("root_lang_attr")),t.ie&&(9===parseInt(t.ie,10)?i.push("lt-ie10"):8===parseInt(t.ie,10)?i.push("lt-ie9"):t.ie<8&&i.push("lt-ie8")),m(i,function(t){t&&n.addClass(e.body,t)}),a.getParam("autohide_toolbar")&&r(a.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").hide(),a.getParam("autohide_menubar")&&r(a.getContentAreaContainer().parentElement).find("div.mce-menubar").hide()}),a.getParam("autohide_toolbar")&&(a.on("focus",function(){r(a.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").show()}),a.on("blur",function(){r(a.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").hide()})),a.getParam("autohide_menubar")&&(a.on("focus",function(){r(a.getContentAreaContainer().parentElement).find("div.mce-menubar").show()}),a.on("blur",function(){r(a.getContentAreaContainer().parentElement).find("div.mce-menubar").hide()})),!1===a.getParam("image_dimensions")&&a.on("NodeChange",function(t){t&&"img"===t.element.nodeName.toLowerCase()&&l.DOM.setAttribs(t.element,{width:null,height:null})})},getDefaultAlignment:function(){return"rtl"===this.editor.getParam("directionality")?"alignright":"alignleft"},filterItems:function(t){var n=this.editor,i=[];return s(t)||(t=t.split(" ")),m(t,function(t){var e;"|"===t?i.push({text:"-"}):t in n.buttons&&((e=a({},n.buttons[t])).text=e.tooltip,delete e.tooltip,delete e.type,i.push(e))}),i}}),l.PluginManager.add("charcoal",l.plugins.Charcoal,l.plugins.Charcoal.dependencies)}(window.tinymce,window.jQuery);